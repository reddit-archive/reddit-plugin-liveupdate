<%!
  from r2.lib.pages import UserText

  EDITOR_CUTOFF = 3
%>

<%namespace name="utils" file="utils.html" />

<header>
<div>
<h1 id="liveupdate-title">${thing.event.title}</h1>
</div>

<div class="tagline">
  % if thing.event.state == "live":
    <p class="state live">${_("live")}</p>
  % endif

  <p id="visitor-count">${_("viewers:")}&nbsp;<span class="count">${thing.visitor_count}</span></p>

  <p>${_("reported by:")}</p>

  <ul>
    % for editor in thing.editors[:EDITOR_CUTOFF]:
    <li>${editor}</li>
    % endfor
  </ul>

  % if len(thing.editors) > EDITOR_CUTOFF:
  <a href="/live/${c.liveupdate_event._id}/reporters" class="more-editors">${unsafe(_("&hellip; and %(count)s more &raquo;") % dict(count=len(thing.editors) - EDITOR_CUTOFF))}</a>
  % endif
</div>
</header>

% if c.liveupdate_can_edit:
<div id="new-update-form" class="prettyform">
  ${UserText(None, text="", editable=True, creating=True, name="body", have_form=False)}

  <div class="save-button">
    <button class="btn" type="button" onclick="return post_pseudo_form('#new-update-form', 'live/${c.liveupdate_event._id}/update')">
      ${_("make update")}
    </button>
    &#32;
    <span class="status error"></span>
  </div>
</div>
% endif

<div class="main-content">
% if thing.show_sidebar:
<aside class="sidebar">
  % if thing.event.description:
  <section class="md">
    ${utils.md(thing.event.description)}
  </section>
  % endif
  <section id="discussions">
    <h1>${_("discussions")}</h1>
    ${thing.discussions}
  </section>
</aside>
% endif

${thing.listing}
</div>
